{
  "cells": [
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "view-in-github",
        "colab_type": "text"
      },
      "source": [
        "<a href=\"https://colab.research.google.com/github/satyamnewale/basic-NLP/blob/main/pytorch-basicipynb\" target=\"_parent\"><img src=\"https://colab.research.google.com/assets/colab-badge.svg\" alt=\"Open In Colab\"/></a>"
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "import torch\n",
        "print(torch.__version__)\n"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "K9IRHgESPFcA",
        "outputId": "44ab72cb-171a-41ea-e9c6-753138fb5653"
      },
      "execution_count": 2,
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "2.9.0+cu126\n"
          ]
        }
      ]
    },
    {
      "cell_type": "markdown",
      "source": [
        "Create a Tensor\n"
      ],
      "metadata": {
        "id": "e7X1vfoDPfuf"
      }
    },
    {
      "cell_type": "code",
      "source": [
        "# using empty\n",
        "a = torch.empty(2,3)\n",
        "print(a)\n",
        "print(type(a),a.shape)"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "oeaKifoPPiD3",
        "outputId": "2fadc46c-60f5-4a02-c889-7af9930fc72b"
      },
      "execution_count": 4,
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "tensor([[4.2528e-32, 0.0000e+00, 2.1740e+05],\n",
            "        [4.4264e-41, 4.4842e-44, 0.0000e+00]])\n",
            "<class 'torch.Tensor'> torch.Size([2, 3])\n"
          ]
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "#using zeros\n",
        "torch.zeros(2,3)"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "yV5WNJwUP4i_",
        "outputId": "59c959e9-6e8d-4b9b-c476-b161b60ae4dc"
      },
      "execution_count": 6,
      "outputs": [
        {
          "output_type": "execute_result",
          "data": {
            "text/plain": [
              "tensor([[0., 0., 0.],\n",
              "        [0., 0., 0.]])"
            ]
          },
          "metadata": {},
          "execution_count": 6
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "#using ones\n",
        "torch.ones(2,3)"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "4ZSiRyzZQC7o",
        "outputId": "a6743da5-8b7f-432c-8ba2-408f76a47a7a"
      },
      "execution_count": 7,
      "outputs": [
        {
          "output_type": "execute_result",
          "data": {
            "text/plain": [
              "tensor([[1., 1., 1.],\n",
              "        [1., 1., 1.]])"
            ]
          },
          "metadata": {},
          "execution_count": 7
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "#using random with manual seed\n",
        "torch.manual_seed(0)\n",
        "torch.rand(2,3)"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "W5rgR4_xQN8Q",
        "outputId": "a2dc937c-fdf4-4cfc-aca5-be561472b078"
      },
      "execution_count": 8,
      "outputs": [
        {
          "output_type": "execute_result",
          "data": {
            "text/plain": [
              "tensor([[0.4963, 0.7682, 0.0885],\n",
              "        [0.1320, 0.3074, 0.6341]])"
            ]
          },
          "metadata": {},
          "execution_count": 8
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "#using tensor\n",
        "torch.tensor([[1,2,3],[4,5,6]])"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "Y4D1UCQRQU27",
        "outputId": "2fa533ca-a6f4-4e6a-e6a7-0bf5fd6f8206"
      },
      "execution_count": 9,
      "outputs": [
        {
          "output_type": "execute_result",
          "data": {
            "text/plain": [
              "tensor([[1, 2, 3],\n",
              "        [4, 5, 6]])"
            ]
          },
          "metadata": {},
          "execution_count": 9
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "#one_like\n",
        "print(torch.ones_like(torch.tensor([[1,2,3],[4,5,6]])))\n",
        "\n",
        "#zero_like\n",
        "print(torch.zeros_like(torch.tensor([[1,2,3],[4,5,6]])))\n",
        "\n",
        "#rand_like\n",
        "print(torch.rand_like(torch.tensor([[1,2,3],[4,5,6]]), dtype = torch.float32))"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "XBh7iYmpULwz",
        "outputId": "2ccdd203-c093-402e-c385-6ef7d6cec961"
      },
      "execution_count": 29,
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "tensor([[1, 1, 1],\n",
            "        [1, 1, 1]])\n",
            "tensor([[0, 0, 0],\n",
            "        [0, 0, 0]])\n",
            "tensor([[0.4901, 0.8964, 0.4556],\n",
            "        [0.6323, 0.3489, 0.4017]])\n"
          ]
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "#other ways\n",
        "\n",
        "#arange\n",
        "print(f\"arange -> {torch.arange(0,10,2)}\")\n",
        "\n",
        "#using linspace\n",
        "print(f\"linspace -> {torch.linspace(0,10,5)}\")\n",
        "\n",
        "#using eye\n",
        "print(f\"eye -> {torch.eye(3,4)}\")\n",
        "\n",
        "# using full\n",
        "print(f\"full -> {torch.full((2,3),2)}\")\n"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "B6l5-rSKQ4TZ",
        "outputId": "114908e9-938a-4fd6-fd56-fcbf4d4a7912"
      },
      "execution_count": 11,
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "arange -> tensor([0, 2, 4, 6, 8])\n",
            "linspace -> tensor([ 0.0000,  2.5000,  5.0000,  7.5000, 10.0000])\n",
            "eye -> tensor([[1., 0., 0., 0.],\n",
            "        [0., 1., 0., 0.],\n",
            "        [0., 0., 1., 0.]])\n",
            "full -> tensor([[2, 2, 2],\n",
            "        [2, 2, 2]])\n"
          ]
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "#Tensor shape\n",
        "\n",
        "x = torch.tensor([[1,2,3],[4,5,6]])\n",
        "print(x.shape)\n",
        "print(f\"strides -> {x.stride()}, byte-size -> {x.element_size()}\")\n",
        "print(f\"dtype -> {x.dtype}, device -> {x.device}\")\n",
        "\n",
        "y = x[:,[0,2]]\n",
        "print(x.storage().data_ptr() == y.storage().data_ptr()) #false means copy\n",
        "print(f\"y -> {y}, strides -> {y.stride()}\")"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "L6C8DU9sRQpv",
        "outputId": "b388991f-1deb-42ed-f309-a8ca4de46b95"
      },
      "execution_count": 22,
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "torch.Size([2, 3])\n",
            "strides -> (3, 1), byte-size -> 8\n",
            "dtype -> torch.int64, device -> cpu\n",
            "False\n",
            "y -> tensor([[1, 3],\n",
            "        [4, 6]]), strides -> (2, 1)\n"
          ]
        },
        {
          "output_type": "stream",
          "name": "stderr",
          "text": [
            "/tmp/ipython-input-2641425665.py:9: UserWarning: TypedStorage is deprecated. It will be removed in the future and UntypedStorage will be the only storage class. This should only matter to you if you are using storages directly.  To access UntypedStorage directly, use tensor.untyped_storage() instead of tensor.storage()\n",
            "  print(x.storage().data_ptr() == y.storage().data_ptr())\n"
          ]
        }
      ]
    },
    {
      "cell_type": "markdown",
      "source": [
        "Mathematical operation\n",
        "---"
      ],
      "metadata": {
        "id": "OMVhtnulVTuC"
      }
    },
    {
      "cell_type": "code",
      "source": [
        "# scalar operations\n",
        "a = torch.tensor([[1,2],[2,4]])\n",
        "\n",
        "print(f\"a+1 -> {a+1}\")\n",
        "print(f\"a*2 -> {a*2}\")\n",
        "print(f\"a**2 -> {a**2}\")\n",
        "print(f\"a/2 -> {a/2}\")\n",
        "print(f\"a//2 -> {a//2}\")\n",
        "print(f\"a%2 -> {a%2}\")\n",
        "\n",
        "# element wise between two tensors\n",
        "\n",
        "b = torch.rand([2,3])\n",
        "c = torch.rand([2,3])\n",
        "\n",
        "print(f\"b + c -> {b + c}\")\n",
        "print(f\"b * c -> {b * c}\")\n",
        "print(f\"b ** c -> {b ** c}\")\n",
        "print(f\"b / c -> {b / c}\")\n",
        "print(f\"b // c -> {b // c}\")\n",
        "print(f\"b % c -> {b % c}\")\n",
        "\n",
        "# simgle tensor element wise operations\n",
        "print(f\"b.exp() -> {b.exp()}\")\n",
        "print(f\"b.log() -> {b.log()}\")\n",
        "print(f\"b.sqrt() -> {b.sqrt()}\")\n",
        "print(f\"b.sin() -> {b.sin()}\")\n",
        "print(f\"b.cos() -> {b.cos()}\")\n",
        "print(f\"b.abs() -> {torch.abs(b)}\")\n",
        "print(f\"neg -> {b.neg()}\")\n",
        "print(f\"b.ceil() -> {b.ceil()}\")\n",
        "print(f\"b.floor() -> {b.floor()}\")\n",
        "print(f\"b.round() -> {b.round()}\")\n",
        "\n",
        "#clamp\n",
        "print(f\"torch.clamp([[1,3,4],[3,5,1]],2,4) -> {torch.clamp(torch.tensor([[1,3,4],[3,5,1]]),2,4)}\")"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "IDegysOFTkJv",
        "outputId": "20a4b39d-12ac-4a06-9ad0-c8009981dbf8"
      },
      "execution_count": 39,
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "a+1 -> tensor([[2, 3],\n",
            "        [3, 5]])\n",
            "a*2 -> tensor([[2, 4],\n",
            "        [4, 8]])\n",
            "a**2 -> tensor([[ 1,  4],\n",
            "        [ 4, 16]])\n",
            "a/2 -> tensor([[0.5000, 1.0000],\n",
            "        [1.0000, 2.0000]])\n",
            "a//2 -> tensor([[0, 1],\n",
            "        [1, 2]])\n",
            "a%2 -> tensor([[1, 0],\n",
            "        [0, 0]])\n",
            "b + c -> tensor([[1.3151, 0.6534, 0.6708],\n",
            "        [1.3193, 0.7687, 1.5723]])\n",
            "b * c -> tensor([[0.3981, 0.0451, 0.1109],\n",
            "        [0.4163, 0.1121, 0.5899]])\n",
            "b ** c -> tensor([[0.5316, 0.9576, 0.6324],\n",
            "        [0.8880, 0.3928, 0.9711]])\n",
            "b / c -> tensor([[0.5607, 7.3390, 0.7861],\n",
            "        [1.5246, 0.3416, 1.5417]])\n",
            "b // c -> tensor([[0., 7., 0.],\n",
            "        [1., 0., 1.]])\n",
            "b % c -> tensor([[0.4725, 0.0266, 0.2952],\n",
            "        [0.2741, 0.1957, 0.3351]])\n",
            "b.exp() -> tensor([[1.6039, 1.7773, 1.3434],\n",
            "        [2.2182, 1.2162, 2.5953]])\n",
            "b.log() -> tensor([[-0.7498, -0.5533, -1.2200],\n",
            "        [-0.2273, -1.6310, -0.0474]])\n",
            "b.sqrt() -> tensor([[0.6874, 0.7583, 0.5434],\n",
            "        [0.8926, 0.4424, 0.9766]])\n",
            "b.sin() -> tensor([[0.4551, 0.5439, 0.2910],\n",
            "        [0.7150, 0.1945, 0.8156]])\n",
            "b.cos() -> tensor([[0.8905, 0.8392, 0.9567],\n",
            "        [0.6991, 0.9809, 0.5787]])\n",
            "b.abs() -> tensor([[0.4725, 0.5751, 0.2952],\n",
            "        [0.7967, 0.1957, 0.9537]])\n",
            "neg -> tensor([[-0.4725, -0.5751, -0.2952],\n",
            "        [-0.7967, -0.1957, -0.9537]])\n",
            "b.ceil() -> tensor([[1., 1., 1.],\n",
            "        [1., 1., 1.]])\n",
            "b.floor() -> tensor([[0., 0., 0.],\n",
            "        [0., 0., 0.]])\n",
            "b.round() -> tensor([[0., 1., 0.],\n",
            "        [1., 0., 1.]])\n",
            "torch.clamp([[1,3,4],[3,5,1]],2,4) -> tensor([[2, 3, 4],\n",
            "        [3, 4, 2]])\n"
          ]
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "#reduction\n",
        "torch.manual_seed(0)\n",
        "e = torch.randint(size=(2,3),low=0,high=10)\n",
        "print(e)\n",
        "\n",
        "print(f\"e.sum() -> {e.sum()}\")\n",
        "print(f\"e.mean() -> {e.float().mean()}\")\n",
        "print(f\"e.max() -> {e.max()}\")\n",
        "print(f\"e.min() -> {e.min()}\")\n",
        "print(f\"e.prod() -> {e.prod()}\")\n",
        "print(f\"e.std() -> {e.float().std()}\")\n",
        "print(f\"e.var() -> {e.float().var()}\")\n",
        "print(f\"e.median() -> {e.median()}\")\n",
        "\n",
        "#argmax\n",
        "print(f\"e.argmax() -> {e.argmax()}\")\n",
        "print(f\"e.argmax(dim=0) -> {e.argmax(dim=0)}\")\n",
        "print(f\"e.argmax(dim=1) -> {e.argmax(dim=1)}\")\n",
        "\n",
        "#argmin\n",
        "print(f\"e.argmin() -> {e.argmin()}\")\n",
        "print(f\"e.argmin(dim=0) -> {e.argmin(dim=0)}\")\n",
        "print(f\"e.argmin(dim=1) -> {e.argmin(dim=1)}\")"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "6hfayN09VrwZ",
        "outputId": "bb36189c-7a11-4d37-de14-039c5cd748ed"
      },
      "execution_count": 58,
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "tensor([[4, 9, 3],\n",
            "        [0, 3, 9]])\n",
            "e.sum() -> 28\n",
            "e.mean() -> 4.666666507720947\n",
            "e.max() -> 9\n",
            "e.min() -> 0\n",
            "e.prod() -> 0\n",
            "e.std() -> 3.6147844791412354\n",
            "e.var() -> 13.066666603088379\n",
            "e.median() -> 3\n",
            "e.unique(dim = 0 ) -> tensor([[0, 3, 9],\n",
            "        [4, 9, 3]])\n",
            "e.argmax() -> 1\n",
            "e.argmax(dim=0) -> tensor([0, 0, 1])\n",
            "e.argmax(dim=1) -> tensor([1, 2])\n",
            "e.argmin() -> 3\n",
            "e.argmin(dim=0) -> tensor([1, 1, 0])\n",
            "e.argmin(dim=1) -> tensor([2, 0])\n"
          ]
        }
      ]
    },
    {
      "cell_type": "markdown",
      "source": [
        "matrix operations"
      ],
      "metadata": {
        "id": "GMpsSlDFZY6r"
      }
    },
    {
      "cell_type": "code",
      "source": [
        "torch.manual_seed(0)\n",
        "f = torch.rand(size=(2,3))\n",
        "g = torch.rand(size=(3,4))"
      ],
      "metadata": {
        "id": "TLQ-X2y0ZYqC"
      },
      "execution_count": 59,
      "outputs": []
    },
    {
      "cell_type": "code",
      "source": [
        "# matrix multiplication\n",
        "\n",
        "print(f\"matmul : {torch.matmul(f,g)}\")\n",
        "print(f\"mm : {f.mm(g)}\")\n",
        "\n",
        "#transpose\n",
        "print(f\"f : {f}\")\n",
        "print(f\"transpose : {torch.transpose(f,0,1)}\")"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "ML0ZMSCAYJas",
        "outputId": "7dcdd235-845f-4cfa-ba2c-cb44610a3147"
      },
      "execution_count": 61,
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "matmul : tensor([[0.5372, 0.7994, 0.3050, 0.5143],\n",
            "        [0.3583, 0.5706, 0.5094, 0.6427]])\n",
            "mm : tensor([[0.5372, 0.7994, 0.3050, 0.5143],\n",
            "        [0.3583, 0.5706, 0.5094, 0.6427]])\n",
            "f : tensor([[0.4963, 0.7682, 0.0885],\n",
            "        [0.1320, 0.3074, 0.6341]])\n",
            "transpose : tensor([[0.4963, 0.1320],\n",
            "        [0.7682, 0.3074],\n",
            "        [0.0885, 0.6341]])\n"
          ]
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "# special functions\n",
        "import torch.nn.functional as F\n",
        "torch.manual_seed(0)\n",
        "h = torch.randint(size = (2,3),low= 0, high = 10, dtype = torch.float32)\n",
        "\n",
        "# log\n",
        "print(f\"log : {torch.log(h)}\")\n",
        "\n",
        "# exp\n",
        "print(f\"exp : {torch.exp(h)}\")\n",
        "\n",
        "#sqrt\n",
        "print(f\"sqrt : {torch.sqrt(h)}\")\n",
        "\n",
        "#softmax\n",
        "print(f\"softmax : {torch.softmax(h,dim=0)}\")\n",
        "\n",
        "#sigmoid\n",
        "print(f\"sigmoid : {torch.sigmoid(h)}\")\n",
        "\n",
        "#relu\n",
        "print(f\"relu : {torch.relu(h)}\")\n",
        "\n",
        "#leaky relu\n",
        "print(f\"leaky relu : {F.leaky_relu(h)}\")"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "YrR3OKu9Z0-1",
        "outputId": "ad35d611-b2c5-4624-9f2a-78bb5e6b895e"
      },
      "execution_count": 70,
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "log : tensor([[1.3863, 2.1972, 1.0986],\n",
            "        [  -inf, 1.0986, 2.1972]])\n",
            "exp : tensor([[5.4598e+01, 8.1031e+03, 2.0086e+01],\n",
            "        [1.0000e+00, 2.0086e+01, 8.1031e+03]])\n",
            "sqrt : tensor([[2.0000, 3.0000, 1.7321],\n",
            "        [0.0000, 1.7321, 3.0000]])\n",
            "softmax : tensor([[0.9820, 0.9975, 0.0025],\n",
            "        [0.0180, 0.0025, 0.9975]])\n",
            "sigmoid : tensor([[0.9820, 0.9999, 0.9526],\n",
            "        [0.5000, 0.9526, 0.9999]])\n",
            "relu : tensor([[4., 9., 3.],\n",
            "        [0., 3., 9.]])\n",
            "leaky relu : tensor([[4., 9., 3.],\n",
            "        [0., 3., 9.]])\n"
          ]
        }
      ]
    },
    {
      "cell_type": "markdown",
      "source": [
        "Inplace operaion\n",
        "---"
      ],
      "metadata": {
        "id": "mslZgm_QhF8N"
      }
    },
    {
      "cell_type": "code",
      "source": [
        "m = torch.rand(2,3)\n",
        "n = torch.rand(2,3)\n",
        "\n",
        "print(f\"m: {m}, n: {n}\")\n",
        "m.add_(n)\n",
        "print(f\"m: {m}, n: {n}\")\n"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "muXRZqt9gJlI",
        "outputId": "e9d54697-b6e8-49d6-b707-0d03d7961f26"
      },
      "execution_count": 71,
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "m: tensor([[0.4901, 0.8964, 0.4556],\n",
            "        [0.6323, 0.3489, 0.4017]]), n: tensor([[0.0223, 0.1689, 0.2939],\n",
            "        [0.5185, 0.6977, 0.8000]])\n",
            "m: tensor([[0.5124, 1.0653, 0.7495],\n",
            "        [1.1508, 1.0466, 1.2017]]), n: tensor([[0.0223, 0.1689, 0.2939],\n",
            "        [0.5185, 0.6977, 0.8000]])\n"
          ]
        }
      ]
    },
    {
      "cell_type": "markdown",
      "source": [
        "tensor operations on GPU\n",
        "---"
      ],
      "metadata": {
        "id": "FNd-BkZ7mlCE"
      }
    },
    {
      "cell_type": "code",
      "source": [
        "torch.cuda.is_available()"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "iQjvgcyUhdkV",
        "outputId": "b5f63ce6-8eec-4230-ecc6-ff242e1f0d38"
      },
      "execution_count": 3,
      "outputs": [
        {
          "output_type": "execute_result",
          "data": {
            "text/plain": [
              "True"
            ]
          },
          "metadata": {},
          "execution_count": 3
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "device = torch.device('cuda')"
      ],
      "metadata": {
        "id": "8Xz_ZvISmtQm"
      },
      "execution_count": 4,
      "outputs": []
    },
    {
      "cell_type": "code",
      "source": [
        "#create a new tensor on GPU\n",
        "torch.rand((2,3), device = device)"
      ],
      "metadata": {
        "id": "_NLPl_sHnBNS",
        "outputId": "81d6674f-baf0-4ce6-d6a4-43dae3ab2088",
        "colab": {
          "base_uri": "https://localhost:8080/"
        }
      },
      "execution_count": 6,
      "outputs": [
        {
          "output_type": "execute_result",
          "data": {
            "text/plain": [
              "tensor([[0.0937, 0.0446, 0.7909],\n",
              "        [0.1849, 0.9596, 0.2167]], device='cuda:0')"
            ]
          },
          "metadata": {},
          "execution_count": 6
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "#moving existing cpu tensor to gpu\n",
        "a = torch.rand(2,3)\n",
        "\n",
        "b= a.to(device)\n",
        "print(b)"
      ],
      "metadata": {
        "id": "pSrXzR3pnOBQ",
        "outputId": "0d744c63-e33b-4728-c3f4-740d30d3acfb",
        "colab": {
          "base_uri": "https://localhost:8080/"
        }
      },
      "execution_count": 8,
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "tensor([[0.8999, 0.4545, 0.4996],\n",
            "        [0.5096, 0.5209, 0.5154]], device='cuda:0')\n"
          ]
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "#cpu vs gpu\n",
        "\n",
        "import time\n",
        "\n",
        "#define size matrix\n",
        "size = 10000\n",
        "\n",
        "# create random matrices on CPU\n",
        "matrix_cpu1 = torch.randn(size,size)\n",
        "matrix_cpu2 = torch.randn(size,size)\n",
        "\n",
        "# measure time on cpu\n",
        "start_time = time.time()\n",
        "result_cpu = torch.matmul(matrix_cpu1,matrix_cpu2)\n",
        "end_time = time.time()\n",
        "cpu_time = end_time - start_time\n",
        "\n",
        "print(f\"time on cpu: {cpu_time: .4f} sec\")\n",
        "\n",
        "#move matrices to GPU\n",
        "matrix_gpu1 = matrix_cpu1.to('cuda')\n",
        "matrix_gpu2 = matrix_cpu2.to('cuda')\n",
        "\n",
        "#measure time on gpu\n",
        "start_time = time.time()\n",
        "result_gpu = torch.matmul(matrix_gpu1,matrix_gpu2)\n",
        "end_time = time.time()\n",
        "gpu_time = end_time - start_time\n",
        "\n",
        "print(f\"time on gpu: {gpu_time: .4f} sec\")"
      ],
      "metadata": {
        "id": "uN5SEEI5nXMl",
        "outputId": "11059988-3fec-423b-bb77-af9981342cb4",
        "colab": {
          "base_uri": "https://localhost:8080/"
        }
      },
      "execution_count": 5,
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "time on cpu:  24.8058 sec\n",
            "time on gpu:  0.1226 sec\n"
          ]
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [],
      "metadata": {
        "id": "ekjobLZjo4Se"
      },
      "execution_count": null,
      "outputs": []
    }
  ],
  "metadata": {
    "colab": {
      "name": "Welcome To Colab",
      "provenance": [],
      "gpuType": "T4",
      "include_colab_link": true
    },
    "kernelspec": {
      "display_name": "Python 3",
      "name": "python3"
    },
    "accelerator": "GPU"
  },
  "nbformat": 4,
  "nbformat_minor": 0
}